<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>06.fetch 프라미스</title>
</head>
<script type="module">
    // 데이터를 다른서버에서 가져올 경우
    // 같은 서버를 

    // 참고 : w3schools
    // => https://www.w3schools.com/js/js_api_fetch.asp

    /* 
        [fetch API란?]
        Fetch API 인터페이스를 사용하면 웹 브라우저가 웹 서버에 HTTP 요청을 할 수 있습니다.
        😀 더 이상 XMLHttpRequest가 필요하지 않습니다.

        - [사용법 1]: 

        나변수 = 웹상파일주소;
        
        fetch(나변수) // 웹상파일로드
        .then(x=>x.text()) // 로드후 텍스트 읽기
        .then(y=> 명령어사용) // 텍스트 읽은 후 어떤 코드 실행

        - [사용법 2]: 

        나변수 = 웹상파일주소;

        // async 함수만들기
        async funtion 비동기함수(나변수){
            변수1 = await fetch(나변수); // fetch() 기다림
            변수2 = await 변수1.text(); // text() 기다림
            하고싶은코드.... // 위의 코드가 완료된 후에 실행함
        } /// 비동기함수 /////////////////

        // 적절한 곳에서 비동기함수 호출
        비동기함수(나변수);
    */

    // 웹에 공개된 텍스트파일
    let file="https://tombap8.github.io/FED-RF-2023-TOM/500.%ED%95%84%EA%B8%B0%EB%AA%A8%EC%9D%8C/013.DOM%EC%9D%B4%EB%9E%80.txt"; 

    // 변환없이 화면에 출력하기
    // document.querySelector('.exp').innerHTML = file;
    const tg = document.querySelector('.exp');
    // 웹 주소의 파일을 fetch 하기 -> 실제 파일 가져오기
    fetch(file)
    .then(x=>x.text())
    .then(y=>tg.innerHTML= x);
    // 내용읽기 후 화면에 뿌림!

    // 테스트2- 제이슨 파일
    let file2 = "https://tombap8.github.io/FED-PJ-2022-tom/004.JS%ED%95%99%EC%8A%B5/JS%EB%B9%84%EB%8F%99%EA%B8%B0/defaultSettings.json";
    
    // async 함수 
    async function getFile(fData){
        // 1. 파일 포드까지 기다려~
        let myFetch = await fetch(fData);
        // 2. 로드된 파일 내용 읽을때까지 기다려~
        let myText = await myFetch.text();
        
        // 3. 위의 1,2번 순서대로 완료 후 출력하기
        tg.innerHTML += myText;
    }

    // 비동기함수 호출
    getFile(file2);
</script>
<body>
    <h3 class="exp"></h3>
</body>
</html>